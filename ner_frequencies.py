import json

import spacy
import spacy.attrs
import numpy

from transformers import AutoTokenizer, AutoModelForTokenClassification
from transformers import pipeline

import secrets
import utils

#tokenizer = AutoTokenizer.from_pretrained("dslim/bert-base-NER")
#model = AutoModelForTokenClassification.from_pretrained("dslim/bert-base-NER")

tokenizer = AutoTokenizer.from_pretrained("dslim/bert-large-NER")
model = AutoModelForTokenClassification.from_pretrained("dslim/bert-large-NER")

#nlp = spacy.load('en_core_web_sm')
nlp = pipeline("ner", model=model, tokenizer=tokenizer, grouped_entities=True)

#text_to_check_device = "oui_vendor': ['AMPAK Technology, Inc.'], 'dhcp.option.hostname': ['August-Doorbell-Cam-D2GTH00390'], 'dns.ptr.domain_name': [], 'http.user_agent': ['PubNub-C-core/2.2'], 'dns.qry.name': ['doorbells.august.com', 'ce3977996a44420d92aa-e1b41b2a25897830423caabaf43c1ef1.ssl.cf1.rackcdn.com', 'august.pubnub.com', 'dmsv2.video-cloud.net', 'rpsv4.video-cloud.net', 's3-us-west-2.amazonaws.com', 'rpsv1.video-cloud.net', 'rpsv10.video-cloud.net', '1.0.0.127.IN-ADDR.ARPA', '36.0.168.192.in-addr.arpa', 'vcsv2.video-cloud.net', 'iconfig.august.com', 'v2servers.video-cloud.net', 'rbs.august.com', 'rpsv3.video-cloud.net', 'rpsv2.video-cloud.net', 'rpsv222.video-cloud.net', 'rpsv5.video-cloud.net', 'rpsv11.video-cloud.net', 'rpsv13.video-cloud.net', 'rpsv12.video-cloud.net', 'rbs-sticky.august.com'], 'tls.handshake.extensions_server_name': ['doorbells.august.com', 'ce3977996a44420d92aa-e1b41b2a25897830423caabaf43c1ef1.ssl.cf1.rackcdn.com', 'dmsv2.video-cloud.net', 's3-us-west-2.amazonaws.com', 'vcsv2.video-cloud.net', 'iconfig.august.com', 'v2servers.video-cloud.net', 'rbs.august.com', '34.202.99.86', '54.156.10.130', 'rbs-sticky.august.com', '34.205.198.236', '52.7.165.163'], 'x509ce.dNSName': ['*.ssl.cf1.rackcdn.com', '*.pubnub.com', '*.video-cloud.net', 's3-us-west-2.amazonaws.com', '*.august.com', 'rbs-sticky.august.com', 'doorbells.august.com'], 'x509sat.printableString': ['California', 'DigiCert Inc', 'Arizona', 'Greater Manchester', 'Amazon', 'Domain Control Validated'],, 'hostname_google': [('August-Doorbell-Cam-D2GTH00390', 0, 'This article links to installation guides for all of August's doorbell cameras. Select the Get Started guide for the type of doorbell you would like to ...August Doorbell Cam Installation Guides'), ('August-Doorbell-Cam-D2GTH00390', 0, 'Arlo Essential Wired Video Doorbell - HD Video, 180° View, Night Vision, 2 Way Audio, DIY Installation (wiring required), Security Camera, Doorbell Camera, Home ...August Doorbell Cam - Amazon.com'), ('August-Doorbell-Cam-D2GTH00390', 1, 'Read the CNET review here - http://cnet.co/1qcmUphThe $199 Doorbell Cam by startup August lets you see who's at your front door straight ...August's Doorbell Cam is smarter than your front door buzzer'), ('August-Doorbell-Cam-D2GTH00390', 1, 'The August Doorbell Cam delivers the sharpest video image of any doorbell camera we've seen, but some of its features are not ready for prime ...August Doorbell Cam Review - PCMag'), ('August-Doorbell-Cam-D2GTH00390', 2, 'This doorbell camera provides a sharp, clear picture of what's happening on your doorstep.August Doorbell Cam Pro 2 review: This is a good-looking ...'), ('August-Doorbell-Cam-D2GTH00390', 2, 'August Home's new smart video doorbell, Doorbell Cam Pro is the 2nd generation video doorbell for August. New features make it a must have ...August Doorbell Cam Pro Review - Gearbrain')], 'domains_google': [('doorbells.august.com', 0, 'Your smart home starts at the front door. Control and monitor your home from anywhere with August Smart Locks, Smart Keypads and accessories!August Home | Smart Locks for Convenient, Keyless Entry'), ('doorbells.august.com', 0, 'This article links to installation guides for all of August's doorbell cameras. Select the Get Started guide for the type of doorbell you would like to ...August Doorbell Cam Installation Guides'), ('doorbells.august.com', 1, 'Open the August App · From the menu in the top left corner of the App, choose Set up a Device. · Tap Set up an August Doorbell Cam, and choose your model and ...Setting Up Your Doorbell Camera in the August App'), ('doorbells.august.com', 1, 'The August Doorbell Cam provides similar functionality to products such as SkyBell and Ring in a slim, attractive package. When paired with an August Smart Lock ...Doorbell Cam FAQ - August Support'), ('doorbells.august.com', 2, 'If your Doorbell Cam is synced to an August Smart Lock (for the August View, you'll also need an August Connect), you can lock and unlock the door for ...How to Operate Your Smart Lock Using Your Doorbell Cam'), ('doorbells.august.com', 2, 'August products are compatible with a variety of other smart home brands and ... devices of activity at your doorstep with all August Doorbell Cameras.August Smart Lock Integrations | What Works With August?'), ('doorbells.august.com', 3, 'All August Smart Locks are Bluetooth® LE integrated for keyless entry, but require a separate Wi-Fi bridge to enable remote access and voice speaker ...August Smart Lock + Connect | Products | August Home'), ('doorbells.august.com', 3, 'August View Doorbell Chime · Voltage Requirements: 100-120V ~50-60Hz 0.1A · Dimensions: 2.4' (W) x 2.4' (H) x 1.5'(D) · Device Weight: 3.0oz · Range: approx. 100ft ...Doorbell Cam and August View and Chime Operating Specs'), ('doorbells.august.com', 4, 'August View doorbell camera features · Rechargeable battery · 1440p resolution · Two-way audio · Infrared night vision · IPX5 weather rating · -4º F to 122º F (-20º C ...August View Doorbell Camera: Is It Worth the Price?'), ('doorbells.august.com', 4, 'August Doorbell Cam also detects motion from visitors, identifying people at your door, even if they don't ring the bell, and sends you an instant alert to ...August Home AB-R1 Silver August Doorbell Camera, 1st ...'), ('august.pubnub.com', 0, 'Average performance per day for the selected month. Response Time Per Country. Average performance by country during the selected month.PubNub Website (August 2022) - Pingdom Public Reports Overview'), ('august.pubnub.com', 0, 'PubNub is proud to announce the release of the new Events & Actions feature with a free preview until Aug 31, 2022.New Product Release: Events & Actions Free Preview - PubNub'), ('august.pubnub.com', 1, 'This page contains the Latest Feature Releases of PubNub SDKs, powering real time communication for every industry. (AUG 2019)Latest Feature Releases AUG 2019 - PubNub'), ('august.pubnub.com', 1, 'This page contains the Latest Feature Releases of PubNub SDKs, powering real ... a free preview of our new Events & Actions feature until August 31, 2022.All of our Latest Feature Releases - PubNub'), ('august.pubnub.com', 2, 'PubNub is offering a free preview of our new Events & Actions feature until August 31, 2022. Events & Actions is powerful event filtering with a simple UI ...Latest Feature Releases JUN 2022 - PubNub'), ('august.pubnub.com', 2, 'Latest real-time communication news. Press. Aug. 30, 2022. PubNub is Awarded ISO-27001 Certification. PubNub, the leading ...PubNub News, Corporate Announcements, Media Coverage'), ('august.pubnub.com', 3, 'PubNub SDK EOL Policy'), ('august.pubnub.com', 3, 'PubNub Data Stream Network is a secure global Data Stream Network that enables ... West Coast, Western US; Founded Date Aug 1, 2010; Founders Stephen Blum, ...PubNub - Crunchbase Company Profile & Funding'), ('august.pubnub.com', 4, 'See what developers are saying about how they use PubNub. ... Project Manager at Devmagic · Aug 28, 2019 | 2 upvotes · 11.4K views. Needs advice. on. PubNub.Reviews, Pros & Cons | Companies using PubNub - StackShare'), ('august.pubnub.com', 4, 'Aug 2, 2019 ... Check out this @Hacksterio tutorial using @PubNub and Chirp! ... Chandler brought the PubNub Teleporter, powered by PubNub and.Chandler Mayo (@MayoChandler) / Twitter'), ('dmsv2.video-cloud.net', 0, 'How to change Office 365 ProPlus channels.Channel Management,Office 365 ProPlus'), ('dmsv2.video-cloud.net', 0, 'The FHWA has developed a series of training modules to guide users on the use of ITS standards. The T201 module is intended for engineers, operational staff, ...ITS Standards Training Modules'), ('dmsv2.video-cloud.net', 1, 'Explore Instagram posts for tag #kickoffproject - Picuki.com.kickoffproject Instagram posts (photos and videos)'), ('dmsv2.video-cloud.net', 1, 'Whether casual or professional interest in graphics from Video - you must have a ... New Amiga logo AMIGA As those of you with access to the Internet will ...Full text of 'Amiga Shopper Magazine Issue 54'), ('dmsv2.video-cloud.net', 2, 'd0r0v, msnbcpod.vo.llnwd.net, http://msnbcpod.vo.llnwd.net/l1/video/podcast/ ... original/inline/2015/03/3042436-inline-i-1-ro-dropbox-cloud-atlas-chart.png.Jobs - ArchiveBot Viewer - Archive Fart'), ('rpsv4.video-cloud.net', 0, 'Top Tax & Revenue Collection Software. Choose the right Tax & Revenue Collection Software using real-time, up-to-date product reviews from ...Best Tax & Revenue Collection Software in 2023'), ('rpsv4.video-cloud.net', 0, 'Tioga County may make video and audio recordings of on-site training and webinars at no extra charge. ☐. ☐. Click here to enter text. A data ...tax-collection-rfp-2017-03.pdf'), ('rpsv4.video-cloud.net', 1, 'Discussion and Vote: Agreement with Cloud Navigator for Microsoft O365 ... Golub stated the network would allow for smart city.CITY OF SARATOGA SPRINGS'), ('rpsv4.video-cloud.net', 1, 'RPSV4 was originally developed as a client server – “thick” desktop application. However, within a few short years, the internet and web application ...assessment | eSpatially New York'), ('rpsv4.video-cloud.net', 2, '5:00 PM – Village Board Work Session – Zoom Video ... connection with the internet or any web hosting, wide area network (WAN), virtual ...Village of Scarsdale'), ('rpsv4.video-cloud.net', 2, 'health, safety net programs and recreational services. ... the RPSV4 Assessment system, in order to be in compliance with legislative changes in real.Book A operAting Funds - Erie County'), ('rpsv4.video-cloud.net', 3, 'files to be applied to the County RPSV4 master file; ... video workshops, meetings with civic & community groups, interaction with local ...REGULAR TOWN BOARD MEETING AUGUST 16, 2022 7: ...'), ('rpsv4.video-cloud.net', 3, 'Remote Access: Contains a remote desktop related string; Network Behavior: Contacts ... Get your own cloud service or the full version to view all details.Proof of payment2.html'), ('rpsv4.video-cloud.net', 4, 'The Contractor will provide a public informational video to be utilized on ... The informal review sites will need to have internet access, ...Town Clerk's Office Town of Greenburgh February 26, 2014'), ('s3-us-west-2.amazonaws.com', 0, 'Amazon Simple Storage Service (Amazon S3) is an object storage service offering industry-leading scalability, data availability, security, and performance.Amazon S3 - Cloud Object Storage - AWS'), ('s3-us-west-2.amazonaws.com', 0, 'Configure an Amazon S3 bucket for website hosting to make it available through ... http://example-bucket.s3-website.us-west-2.amazonaws.com/docs/doc1.html ...Amazon Simple Storage Service endpoints and quotas'), ('s3-us-west-2.amazonaws.com', 1, 'Domain: s3-us-west-2.amazonaws.com - Open Threat Exchange'), ('s3-us-west-2.amazonaws.com', 1, 'What is 's3-us-west-2-r-w.amazonaws.com' and why I receive a lot of traffic from this US server when in EU? Title says it all. guildmate claims ...What is 's3-us-west-2-r-w.amazonaws.com' and why I receive ...'), ('s3-us-west-2.amazonaws.com', 2, 'One of the examples that you might have come across is the S3.amazonaws.com pop-up (also called Amazonaws virus) which indicates that adware ...How to Remove S3.amazonaws.com Pop-ups - Cybernews'), ('s3-us-west-2.amazonaws.com', 2, 'easypost-files.s3-us-west-2.amazonaws.com is ranked #6841 in the Lifestyle > Fashion and Apparel category and #845610 Globally according to December 2022 ...easypost-files.s3-us-west-2.amazonaws.com - SimilarWeb'), ('s3-us-west-2.amazonaws.com', 3, 'The s3.amazonaws.com virus is tricky because it's a legitimate site for Amazon's AWS service. But due to likely adware, your Mac is showing ...How to get rid of s3.amazonaws.com redirect - MacPaw'), ('s3-us-west-2.amazonaws.com', 3, 'telnet s3.ap-southeast-2.amazonaws.com 443 ... nslookup s3.amazonaws.com ... If you run a sync command using --region us-west-1 when the VPC endpoint is in ...Troubleshoot endpoint URL connection error in Amazon S3'), ('rpsv1.video-cloud.net', 0, 'Programs (Game Tools)) bnetcalc.zip Battle.net Ladder Calculator v1.2 ... Journey cloud.8xp Cloud Land - for Mario v1.2 cloudwld.zip Cloud World for Mario ...Master Index - Ticalc.org'), ('rpsv1.video-cloud.net', 0, 'Network specification of each ECU (milestone + 2 weeks) ... DIPV chief CR RPSV1 VC VC Pre Note Program DIPV chief technical Info about MC batch Project ...02.seance LDP DEVELOPPEMENT V3P - ENV1 | PDF - Scribd'), ('rpsv1.video-cloud.net', 1, '2014年度 JPP-NET ヒメトビウンカ飛来予測システムの実運用 ... 2012年度 Strategy and Concept of Open Cloud Application Platform in Agriculture.国立研究開発法人 農業・食品産業技術総合研究機構'), ('rpsv1.video-cloud.net', 1, 'HumanitarianNet; Thematic Network on Humanitarian. ... escena premonitoria – a la proclamaci&oacute;n del Emperador en Saint-Cloud, el 18 de mayo de 1804, ...1era parte - Revista Encuentros Uruguayos - Studylib'), ('rpsv10.video-cloud.net', 0, 'Cloud 9 Massage Studio York Pa. ... قم بتنزيل عرض NDS Cartoon Network Racing. ... Meek Mill Ft Kendrick Lamar A1 Everything Video Text.مسجل: 2022-12-11'), ('vcsv2.video-cloud.net', 0, 'World Wide Web Access Statistics for www.otaru-uc.ac.jp · Totals for Summary Period: Jun 1 2011 to Jun 30 2011 · Total Transfers by Request Date.Totals for Summary Period: Jun 1 2011 to Jun 30 2011'), ('vcsv2.video-cloud.net', 0, 'Articles V.en - , OnLine Tutorial, e-Books & Tutorials, Articles, Bookstore, Curriculum, Directory, Education, Electronic, Emulation, Free Software, ...Articles V.en | On-Line Technology'), ('iconfig.august.com', 0, 'In the notification tab it says 'Invalid config'. I haven't made any changes so I am wondering why it's now missing.August Lock Invalid Config'), ('iconfig.august.com', 0, 'august-connect · GitHub CI status. A simple module for locking, unlocking, and getting the status of August smart locks via the August Connect WiFi bridge.August-connect'), ('iconfig.august.com', 1, 'I have two August gen 3 locks with 2 august Connects. Both Connects showed solid red LED ... iconfig-rlcn.aaecosys.com:443. Establishing Connection - 129 ms.August Connect lost its connection. : r/AugustSmartLock'), ('iconfig.august.com', 1, 'First things first, we need a confirmed August access token so clone ... config/config.august.json as the x-august-access-token value in the ...Why doesn't August Lock have a scheduler? Here's how to ...'), ('iconfig.august.com', 2, 'August 2021. This is a legit question. I'll give you the straight answer on this. iConfig was created by a previous developer many years ago ...IConfig iOS'), ('iconfig.august.com', 2, 'Hyperion BI+ - Version 11.1.2.3.500 and later: Error When Signing Into Workspace: 'com/hyperion/bpm/config/IConfig.Symptoms - My Oracle Support'), ('iconfig.august.com', 3, 'Vila Velha - ES - Brasil blog.i-config.com.br Joined August 2009. 20 Following · 2 Followers · Tweets · Tweets & replies.I-Config TI (@ICONFIG) / Twitter'), ('iconfig.august.com', 3, 'Recovering Windows Servers · January 21, 2019 - 7:28 pm · Uncategorized, Windows ; WPS Pixie Dust Attack · August 2, 2015 - 1:13 pm · Networking, ...ifconfig.dk'), ('iconfig.august.com', 4, 'iConfig is available as a free download from the App Store. August 25, 2013 synthheadMIDI InterfacesiConnectivity, iPad Music Software, iPhone music ...iConnectivity Intros Free iConfig App'), ('v2servers.video-cloud.net', 0, 'Package servers provides information and interaction with the server API resource in the OpenStack Compute service.servers - Go Packages'), ('v2servers.video-cloud.net', 0, 'An OrderedDict, keyed by network name, and sorted by network name in ascending order. pause()¶. Pause – Pause the running server. Returns.novaclient.v2.servers module - OpenStack Documentation'), ('v2servers.video-cloud.net', 1, 'GV-Dispatch Server is a network management application that distributes a large number of video surveillances across multiple GV-Center V2 servers.GV-Dispatch Server - Large Scale Monitoring - GeoVision'), ('v2servers.video-cloud.net', 1, 'Build Video Into Your App Today. Start building video into your app or service today with a free Wowza Video account. No credit card required.Manage live applications - Wowza'), ('v2servers.video-cloud.net', 2, 'Lenovo Infrastructure Solutions Group has just announced the new ThinkSystem V2 family of two-socket servers, based on the third-generation ...What's New - ThinkSystem V2 Servers - Lenovo Press'), ('v2servers.video-cloud.net', 2, 'Watch this video, courtesy of Perfect Video Conferencing, ... Saama is the #1 AI-powered clinical analytics cloud platform company ...See a tour of the #Lenovo... - Perfect Video Conferencing'), ('v2servers.video-cloud.net', 3, 'CenturyLink Public Cloud provides an API for performing the same actions ... POST https://api.ctl.io/v2/servers/BTDI HTTP/1.1 Host: api.ctl.io Content-Type: ...Using the API - Hybrid Cloud and IT Solutions'), ('v2servers.video-cloud.net', 3, '... 'Content-Type:application/json; charset=utf-8' http://localhost:8087/v2/servers/_defaultServer_/vhosts/_defaultVHost_/applications/test/streamfiles.Manage stream files by using the Wowza Streaming Engine'), ('v2servers.video-cloud.net', 4, '... have a handful of UniFi Video servers managed as well. Before UCRM was integrated into UNMS v1, we were also managing UCRM v2 servers.Why we're reinvesting in our UNMS cloud hosting product - Blog'), ('rbs.august.com', 0, 'I have the August Connect and a outbound (egress) ports blocked (except for ... it's reaching out to this DNS Name: rbs-sticky.august.com.August Connect required ports or static IP : r/AugustSmartLock'), ('rbs.august.com', 0, 'Your smart home starts at the front door. Control and monitor your home from anywhere with August Smart Locks, Smart Keypads and accessories!August Home | Smart Locks for Convenient, Keyless Entry'), ('rbs.august.com', 1, 'Subdomains of august.com - SecurityTrails'), ('rbs.august.com', 1, 'Our real-world experiments with. August Lock and other IoT devices demonstrated the feasibility of developing an automated system to learn and ...IoTAthena: Unveiling IoT Device Activities from Network Traffic'), ('rbs.august.com', 2, 'We are less than one month away from RBS training and certification for ... those who need to be RBS trained and certified by the August 31, 2022 deadline.RBS - Alcoholic Beverage Control - CA.gov'), ('rpsv222.video-cloud.net', 0, '... a her cum free of. safado wiebke video best internet for party gang. ripped ... raw g.i. naked from cloud de indian the? d.va dildo trained naked karate ...Untitled'), ('rpsv5.video-cloud.net', 0, '&#9642; Drive net new product offerings to customers (Credit Card, Secured, ... Highly Available and Secure Platform Powered by AWS Cloud native &#9642; ...0001712923-21-000004.txt'), ('rpsv5.video-cloud.net', 0, '... the cloud with Dropbox. The app also comes pre-loaded with aerial imagery. Learn more about Leica Zeno GIS technology via online training videos here.mobile GIS | eSpatially New York'), ('rpsv5.video-cloud.net', 1, 'print tax bills using extracts from NYS RPSV4 and future RPSV5 databases. Tax Billing , Tax Collection, Delinquent.tax-collection-rfp-2017-03.pdf'), ('rpsv5.video-cloud.net', 1, 'A Secure Scheme for Fixed Topology In Wireless Sensor Network. Arya Sony, Selo Sulistyo ... Berbasis Video Processing dengan Metode Variable Module Graph.Abstrak Seminar Nasional (SENIATI) 2016'), ('rpsv12.video-cloud.net', 0, 'Pair of 12.2” inch Sunvisor TFT LCD monitors Universal – Fits in any car Resolution in Pixels: 1280 (W) x RGB X 480 (H) 2 Video Inputs System: PAL/NTSC Can be ...(2) Rockville RPSV12-BK 12.1' Black Car Sun Visor Monitors ...'), ('rpsv12.video-cloud.net', 0, 'Optimize app availability and user experience with intelligent L4-L7 load balancing, SSL/TLS offloading and visibility, and programmatic ...Products - Tech Data - Innovix Marketplace'), ('rpsv12.video-cloud.net', 1, '... www.kmart.com/warner-home-video-network-special-edition/p-SPM10477184408 ... https://www.kmart.com/rockville-adib018l66kf8-2-rockville-rpsv12-bg-12.1- ...Untitled'), ('rpsv12.video-cloud.net', 1, 'F5 delivers cloud and security application services that enable ... Optimise network performance and video traffic Improve subscriber experience Consolidate ...F5 PRODUCT GUIDE EMEA JULY PDF Free Download'), ('rbs-sticky.august.com', 0, 'I have two August gen 3 locks with 2 august Connects. Both Connects showed solid red LED light about half year ago. ... rbs-sticky-rlcn.aaecosys.com:443.August Connect lost its connection. : r/AugustSmartLock - Reddit'), ('rbs-sticky.august.com', 0, 'seeking three room apt to rent from august, long term, rbs gimmel. More. All Messages By This Member. ×Close. Verify Delete. Are you sure you wish to delete ...RBSGimmel@groups.io | seeking three room apt to rent from august ...'), ('rbs-sticky.august.com', 1, 'I can't really find any common denominator for all tree. The August gateway and Grohe seems to be using AWS: rbs-sticky.august.com: rbs-sticky.Strange DNS caching problem - MikroTik - Forum'), ('rbs-sticky.august.com', 1, 'AWARENESS. California food handler training improve critical thinking and decision making to prevent or avoid sticky situations.$7.95 California RBS Online Alcohol Server Training'), ('rbs-sticky.august.com', 2, 'Only eight RBs saw at least 65% of their team\'s carries inside of the 5-yard line last year: ... Any idea how “sticky” this is from one year to the next?Graham Barfield on Twitter: 'Only eight RBs saw at least 65 ...'), ('rbs-sticky.august.com', 2, 'Sticky Subject. Posted on August 3, ... The adhesive on the tape is surprisingly agressive and consistent (at least in major brands).Is It Clean! - Sticky Subject - CTG Technical Blog'), ('rbs-sticky.august.com', 3, 'The bank admitted in August that there was no longer any prospect of spinning this business out onto the stock market and is looking for a trade ...After eight hard years and a £52bn loss, can RBS ever be ...'), ('rbs-sticky.august.com', 3, 'As already stated in announcement D11038 of 25 August 2011, essential parts of the business operations of 'The Royal Bank of Scotland N.V.' will be ...The Royal Bank of Scotland N.V. - Clearstream')], 'user_agents_google': [('PubNub-C-core/2.2', 0, 'Create your first C-Core real-time app that integrates with PubNub in just 10 minutes.PubNub C-Core SDK 4.2.0'), ('PubNub-C-core/2.2', 0, 'This repository has the source for the C/C++ client libraries, designed mostly for embedded systems, but perfectly suitable for 'regular' (POSIX, Windows) ...pubnub/c-core'), ('PubNub-C-core/2.2', 1, 'Pubnub 6.15.0'), ('PubNub-C-core/2.2', 1, 'URL, Age, Size, IPs. ps12.pndsn.com/time/0?uuid=pn-9240dd8b-5b25-452c-a308-8e95c64d64fc, a year, 192 B, 1, 1, 1. ps.pndsn.com/PubNub-C-core/2.2, a year ...54.93.254.235 amazon-02, us'), ('PubNub-C-core/2.2', 2, 'File: pubnub_netcore.c Project: pubnub/c-core. static void outcome_detected(struct pubnub_ *pb, enum pubnub_res rslt) { pb->core.last_result = rslt; ...C++ (Cpp) pbntf_trans_outcome Examples'), ('PubNub-C-core/2.2', 2, 'Learn more about ajb413/pubnub-functions-mock vulnerabilities. pubnub-functions-mock ... babel-core@6.26.3 › babel-traverse@6.26.0 › babel-code-frame@6.26.0 ...Vulnerability report for ajb413/pubnub-functions-mock'), ('PubNub-C-core/2.2', 3, 'Cloud Native Core Licensing Information User Manual'), ('PubNub-C-core/2.2', 3, 'JS, Tierion, RethinkDB, PubNub, and jsreport-core that will allow you to store the ... 10 publish_key: 'pub-c-xxxxx-xxx-xxxx-xxxx-xxxx', ...Proof of existence in the Blockchain with Tierion, ...')], 'tls_issuer_google': [('DigiCert Inc', 0, 'DigiCert ONE is a modern, holistic approach to PKI management. Based on an advanced, container-based design, DigiCert ONE allows you to rapidly deploy in any ...DigiCert.com: SSL Digital Certificate Authority | Encryption ...'), ('DigiCert Inc', 0, 'DigiCert, Inc. is an American digital security company headquartered in Lehi, Utah, with over a dozen global offices in various countries including: ...DigiCert'), ('DigiCert Inc', 1, 'DigiCert is the digital trust provider of choice for leading companies around the globe, enabling individuals, businesses, governments, and consortia to ...DigiCert, Inc.'), ('DigiCert Inc', 1, 'DigiCert, Inc. provides high-assurance SSL certificates to government agencies, financial institutions, educational and medical institutions, and companies ...DigiCert - Crunchbase Company Profile & Funding'), ('DigiCert Inc', 2, 'This organization is not BBB accredited. Internet Service in Lehi, UT. See BBB rating, reviews, complaints, & more.DigiCert, Inc. | Better Business Bureau® Profile'), ('DigiCert Inc', 2, 'DigiCert is the world's PKI leader and foremost CA. It offers a full complement of digital certificates, PKI & website security products for many use cases.DigiCert SSL/TLS Certificates Secure Your Website W'), ('Greater Manchester', 0, 'Greater Manchester is a metropolitan and ceremonial county in North West England, with a population of 2.8 million; comprising ten metropolitan boroughs: ...Greater Manchester'), ('Greater Manchester', 0, 'Greater Manchester, metropolitan county in northwestern England. It encompasses one of the largest metropolitan areas in the country and comprises 10 ...Greater Manchester | region, England, United Kingdom'), ('Greater Manchester', 1, 'Greater Manchester Combined Authority (GMCA) - working together to improve the lives of people in Greater Manchester - Bolton, Bury, Manchester, Oldham, ...Greater Manchester Combined Authority: Home'), ('Greater Manchester', 1, 'Things to Do in Greater Manchester, England: See Tripadvisor's 1417623 traveler reviews and photos of Greater Manchester tourist attractions.Things to Do in Greater Manchester, England - TripAdvisor'), ('Greater Manchester', 2, 'Manchester news updates from the Manchester Evening News team. Covering central and Greater Manchester, including news from Oldham, Rochdale and Glossop.Greater Manchester News'), ('Greater Manchester', 2, 'The voice of business, shaping economic success to enhance the quality of life in Greater Manchester.Greater Manchester Chamber - Largest Chamber in New ...'), ('Greater Manchester', 3, 'Greater Manchester · Oldham Coliseum appoints new board to preserve theatre's legacy and region's culture · Manchester music venue due back in court to appeal ...Greater Manchester | UK news'), ('Greater Manchester', 3, 'At the Greater Manchester Chamber of Commerce we mean business, we offer tailored personalized services to fit every business need!Welcome To The Greater Manchester Chamber Of Commerce'), ('Amazon', 0, 'Free shipping on millions of items. Get the best of Shopping and Entertainment with Prime. Enjoy low prices and great deals on the largest selection of ...Amazon.com. Spend less. Smile more.'), ('Amazon', 0, 'News announcements, original stories, and facts about Amazon.About Amazon'), ('Amazon', 1, 'Official Facebook page of www.amazon.com Seattle, WA. ... Amazon Prime makes your life more convenient, simple, and fun, every single day.Amazon.com - Home'), ('Amazon', 1, 'Learn about Fulfillment center career opportunities, and see open jobs at our Amazon Fulfillment Portal. View fulfillment jobs ...Amazon.jobs: Help us build Earth's most customer-centric ...'), ('Amazon', 2, 'FACT: Cats love Amazon boxes almost as much we love our customers ... Amazon Prime – your one-stop shop to watch, read, listen, and play + + ...Amazon'), ('Amazon', 2, '4m Followers, 61 Following, 2452 Posts - See Instagram photos and videos from Amazon (@amazon)Amazon (@amazon) • Instagram photos and videos'), ('Amazon', 3, 'Amazon marketed free shipping as a differentiator and used pricey Prime subscriptions and fat profits from other businesses to underwrite its ...Amazon, other retailers revamp 'free' shipping as costs soar'), ('Domain Control Validated', 0, 'Domain Control Validation (DCV) methods · Supported DCV methods for validating the domains on DV TLS/SSL certificate orders · Email validation · DNS TXT validation.Domain Control Validation (DCV) methods'), ('Domain Control Validated', 0, 'A domain control validation, or DCV, is used by the CA before issuing an SSL certificate to verify the person making the request is in fact authorized to ...What is domain control validation (DCV)? - Nexcess'), ('Domain Control Validated', 1, 'A Domain Control Validation (DCV) is used by the Certificate Authority (ie Sectigo) before issuing an SSL certificate to verify the person making the request is ...Domain Control Validation (DCV) Methods - Knowledge Base'), ('Domain Control Validated', 1, 'Before an SSL certificate can be issued, the certificate applicant needs to confirm their domain ownership rights. This is called domain control validation ...How can I complete the domain control validation (DCV) for ...'), ('Domain Control Validated', 2, 'On the “Details” page of the pending certificate, click the links in the “Verify File Upload” panel. If the files are uploaded correctly, each ...How do I complete Domain Control Validation (DCV)?'), ('Domain Control Validated', 2, 'Domain Control Validation, or DCV, is the set of approved methods Cert Authorities (CAs) make available to you to prove a domain is yours. DCV must be completed ...What is Domain Control Validation (DCV)? - GeoCerts'), ('Domain Control Validated', 3, 'Before a Certificate Authority will issue a certificate for a domain, the requestor must prove they have control over that domain. This process is known as ...Domain Control Validation (DCV) — SSL/TLS - Cloudflare Docs'), ('Domain Control Validated', 3, 'The sole criterion for a domain validated certificate is proof of control over whois records, DNS records file, email or web hosting account of a domain.Domain-validated certificate - Wikipedia'), ('Domain Control Validated', 4, 'Email-based domain validation can often be the fastest and easiest method. However, due to the nature of the email, being sent from a “no-reply” address by an ...Troubleshooting Domain Control Validation (DCV)')], 'oui_vendors_google': [('AMPAK Technology, Inc.', 0, 'AMPAK Technology is committed to providing a full range of wireless RF modules for consumer networking products, as well as for the Internet of Things, ...Ampak Technology Inc.'), ('AMPAK Technology, Inc.', 0, 'AMPAK Technology provides electronic packaging design and manufacturing for a variety of industrial applications, along with functional testing services.AMPAK Technology - Products, Competitors, Financials ...'), ('AMPAK Technology, Inc.', 1, 'AMPAK TECHNOLOGY is a specialist in Wifi, Bluetooth and GNSS radio modules. AMPAK's unique feature is its advanced packaging technology, which combined with ...AMPAK TECHNOLOGY'), ('AMPAK Technology, Inc.', 1, 'AMPAK Technology Inc. operates as an optical communication and wireless multimedia company. The Company produces wireless communication modules, ...6546: Ampak Technology Inc Stock Price Quote - Taipei'), ('AMPAK Technology, Inc.', 2, 'AMPAK Technology Inc is mainly engaged in manufacturing, wholesale, and retail of wireless communication machinery and equipment, manufacturing of ...Ampak Technology Company Profile'), ('AMPAK Technology, Inc.', 2, 'Ampak Technology is a company founded in 2000 that works with optical communication and wireless multimedia. The company also offers a range of ...What is Ampak Technology? Is it safe?'), ('AMPAK Technology, Inc.', 3, 'AMPAK Technology is engaged in research and development, design, production and marketing of wireless communication modules. Hsinchu, T'ai-wan, Taiwan ...AMPAK Technology - Crunchbase Company Profile & ...')]}"
#doc = nlp(text_to_check_device)

SYSTEM_PROMPT = "You are a smart and intelligent Named Entity Recognition (NER) system. I will provide you the definition of the entities you need to extract, the sentence from where your extract the entities and the output format with examples."
PROMPT_FITLER = "I will provide you a list of elements, extracted by a NER system. For each one of them check if they represent a name of an IoT manufcaturer or another manufcature of Network devices and output it as a list of the elements and True/False flag"

ner_gpt_function = [
        {
            "name": "find_ner",
            "description": "Extracts organizational-type named entities from the input text. For example in the following sentence: 'This article links to installation guides for all of August's doorbell cameras. Select the Get Started guide for the type of doorbell you would like to ...August Doorbell Cam Installation Guides' there is an organzation that manufacture cameras and its name is  'August Doorbell'",
            "parameters": {
                "type": "object",
                "properties": {
                    "entities": {
                        "type": "array",
                        "items": {
                            "type": "object",
                            "properties": {
                                "entity":{"type": "string",
                                          "description": "A Named entity extracted from text."}
                            }
                          }
                        }
                    }
                },
                "required": ["entities"]
            }
        ]

filter_gpt_function = [
        {
            "name": "filter_elements",
            "description": "get as input a list of elemnts and check for each if it represents a name of a manufcaturer of IoT devices or other network device vendor",
            "parameters": {
                "type": "object",
                "properties": {
                    "entities": {
                        "type": "array",
                        "items": {
                            "type": "object",
                            "properties": {
                                "entity":{"type": "string",
                                          "description": "A Named entity extracted from text."},
                                "is_manufacture" : {"type":"boolean", "description":"True or False, whether the name represents a manufcature of IoT devices"}
                            }
                          }
                        }
                    }
                },
                "required": ["entities"]
            }
        ]
import openai

openai.api_key = secrets.api_key_openai

def openai_chat_completion_response(final_prompt,function_name="find_ner",system_prompt=SYSTEM_PROMPT,function=ner_gpt_function):
    dict_results = utils.read_pkl_file(utils.pkl_file_gpt_results_ner)
    key = str(final_prompt) + str(system_prompt) + str(function)
    if key in dict_results:
        response = dict_results[key]
    else:
        response = openai.ChatCompletion.create(
                  model="gpt-4",
                  messages=[
                        {"role": "system", "content": system_prompt},
                        {"role": "user", "content": final_prompt}
                    ],
                functions=function,
                function_call={"name": function_name},
              temperature=0.2,
              top_p=1.0,
              frequency_penalty=0.0,
              presence_penalty=0.0)
    try:
        #print(json.loads(response['choices'][0]['message']['function_call']['arguments']))
        vendors_list_org = json.loads(response['choices'][0]['message']['function_call']['arguments'])['entities']
        vendors_list = [v['entity'] for v in vendors_list_org]
        if function_name == 'filter_elements':
            vendors_list = [v['entity'] for v in vendors_list_org if 'is_manufacture' in v and v['is_manufacture'] == True]
            print([v['entity'] for v in vendors_list_org if 'is_manufacture' in v and v['is_manufacture'] == False])
        print(vendors_list)
        dict_results[key] = response
        utils.save_dict_to_file_pkl(dict_results, utils.pkl_file_gpt_results_ner)
    except:
        print(response['choices'][0]['message']['function_call']['arguments'])
        vendors_list = []
    return vendors_list

def extract_orgs_from_device_using_bert_ner(device,experiment_fields):
    text = ''
    orgs = []
    for field in experiment_fields:
        for item in device[field]:
            text = text + ' ' + item
        text = text + ' '
    doc = nlp(text)
    for ent in doc:
        if ent['entity_group'] in ["ORG"]:
            if ent['word'].lower() not in ["dns",'wi-fi','wifi','ntp','ip','iot','tls','ipv4','ipv6','android','nat']:
                orgs.append(ent['word'].lower())
    return numpy.unique(orgs)

def extract_orgs_from_device_using_gpt_ner(device,experiment_fields):
    text = ''
    orgs = []
    for field in experiment_fields:
        for item in device[field]:
            text = text + ' ' + item
        text = text + ' '
    if len(text) > 8192:
        chunks = []
        docs = []
        for i in range(0, len(text), 8192):
            chunks.append(text[i:i + 8192])
        for chunk in chunks:
            docs.append(openai_chat_completion_response(chunk))
    else:
        #docs = [["a","b"]]
        docs = [openai_chat_completion_response(text)]
    for doc in docs:
        for ent in doc:
            if ent.lower() not in ["dns",'wi-fi','wifi','ntp','ip','iot','tls','ipv4','ipv6','android','nat']:
                orgs.append(ent.lower())
    return numpy.unique(orgs)
def filter_vendors_list_using_gpt(vendor_list):
    chunks = []
    filtered_list = []
    for i in range(0, len(vendor_list), 20):
        chunks.append(vendor_list[i:i + 20])
    for chunk in chunks:
        filtered_list.extend(openai_chat_completion_response(str(chunk),function_name="filter_elements",system_prompt=PROMPT_FITLER,function=filter_gpt_function))
    print(filtered_list)
def vendor_list_acquistion(ext_dict, fields_to_search_in):
    acquired_vendors_list = []
    real_vendor_list = []
    for device in ext_dict:
        #if device not in utils.devices_unique_array:
        #    continue
        #vendors_org = extract_orgs_from_device_using_gpt_ner(ext_dict[device],fields_to_search_in)
        #acquired_vendors_list.extend([x.split(' ')[0] for x in vendors_org])
        #acquired_vendors_list.extend([x.split(',')[0] for x in [x.split(' ')[0] for x in vendors_org]])
        real_vendor_list.append(ext_dict[device]['vendor'])
    acquired_vendors_list = [x.lower() for x in acquired_vendors_list]
    acquired_vendors_list = numpy.unique(acquired_vendors_list).tolist()
    acquired_vendors_list = utils.acquired_by_gpt_vendors_list_gpt_filtered_one_by_one
    #acquired_vendors_list = filter_vendors_list_using_gpt(acquired_vendors_list)
    count = 0
    unknown_vendors = []
    for vendors in real_vendor_list:
        flag = False
        for vendor in vendors:
            if vendor.lower() in acquired_vendors_list:
                count = count + 1
                flag = True
                break
        if not flag:
            if type(vendors) == type([]):
                if vendor[0] not in unknown_vendors:
                    unknown_vendors.append(vendors[0])
    real_vendor_list = [tuple(x) for x in real_vendor_list]
    real_vendor_list = numpy.unique(real_vendor_list).tolist()
    unknown_vendors = numpy.unique(unknown_vendors).tolist()
    print(f"amount of unknown vendors is {len(unknown_vendors)} unknown_vendors: {unknown_vendors}")
    print(f"amount of unique vendors is {len(real_vendor_list)} real_vendors: {real_vendor_list}")
    print(acquired_vendors_list)
